mudel_bilog4 <- glm(netbin ~ agea + gndr + Haridus + gndr*Haridus, family=binomial(link="logit"), data=netidf, weights=pspwght)
mudel_bilog5 <- glm(netbin ~ agea + gndr + Haridus, family=binomial(link="logit"), data=netidf, weights=pspwght)
PseudoR2(mudel_bilog, which=c("Nagelkerke", "CoxSnell", "McFadden"))
PseudoR2(mudel_bilog2, which=c("Nagelkerke", "CoxSnell", "McFadden"))
PseudoR2(mudel_bilog3, which=c("Nagelkerke", "CoxSnell", "McFadden"))
PseudoR2(mudel_bilog4, which=c("Nagelkerke", "CoxSnell", "McFadden"))
PseudoR2(mudel_bilog5, which=c("Nagelkerke", "CoxSnell", "McFadden"))
mudel_bilog <- glm(netbin ~ agea + gndr + Haridus + agea*gndr + gndr*Haridus + agea*Haridus*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
mudel_bilog2 <- glm(netbin ~ agea + gndr + Haridus + agea*gndr + gndr*Haridus, family=binomial(link="logit"), data=netidf, weights=pspwght)
mudel_bilog3 <- glm(netbin ~ agea + gndr + Haridus + agea*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
PseudoR2(mudel_bilog, which=c("Nagelkerke", "CoxSnell", "McFadden"))
PseudoR2(mudel_bilog2, which=c("Nagelkerke", "CoxSnell", "McFadden"))
PseudoR2(mudel_bilog3, which=c("Nagelkerke", "CoxSnell", "McFadden"))
mudel_bilog <- glm(netbin ~ agea + gndr + Haridus + agea*gndr + agea*Haridus*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
mudel_bilog3 <- glm(netbin ~ agea + gndr + Haridus + agea*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
PseudoR2(mudel_bilog, which=c("Nagelkerke", "CoxSnell", "McFadden"))
PseudoR2(mudel_bilog3, which=c("Nagelkerke", "CoxSnell", "McFadden"))
mudel_bilog <- glm(netbin ~ agea + gndr + Haridus + agea*gndr + agea*Haridus*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
mudel_bilog2 <- glm(netbin ~ agea + gndr + Haridus + agea*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
summary(mudel_bilog)
summary(mudel_bilog2)
lrtest(mudel_bilog, mudel_bilog2)
?lrtest()
library(lmtest)
lrtest(mudel_bilog, mudel_bilog2)
mudel_bilog <- glm(netbin ~ agea + gndr + Haridus + agea*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
mudel_bilog2 <- glm(netbin ~ agea + gndr + Haridus + agea*gndr + Haridus*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
lrtest(mudel_bilog, mudel_bilog2)
mudel_bilog <- glm(netbin ~ agea + gndr + Haridus + agea*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
mudel_bilog2 <- glm(netbin ~ agea + gndr + Haridus, family=binomial(link="logit"), data=netidf, weights=pspwght)
lrtest(mudel_bilog, mudel_bilog2)
mudel <- lm(juurnet ~ agea + gndr + Haridus + agea*gndr, data=netidf, weights=pspwght)
summary(mudel)
mudel <- lm(juurnet ~ agea + gndr + Haridus + agea*gndr + Haridus*gndr, data=netidf, weights=pspwght)
summary(mudel)
mudel <- lm(juurnet ~ agea + gndr + Haridus + agea*gndr + Haridus*gndr*agea, data=netidf, weights=pspwght)
summary(mudel)
```{r}
mudel <- lm(juurnet ~ agea + gndr + Haridus + agea*gndr, data=netidf, weights=pspwght)
summary(mudel)
mudel <- lm(juurnet ~ agea + gndr + Haridus, data=netidf, weights=pspwght)
summary(mudel)
mudel <- lm(juurnet ~ agea + gndr + Haridus + agea*gndr, data=netidf, weights=pspwght)
summary(mudel)
par(mfrow=c(2,2))
plot(mudel)
par(mfrow=c(1,1))
plot(mudel, 4)
ols_vif_tol(mudel)
library(nnet)
mudel_multilog <- multinom(netimult ~ agea + gndr + Haridus + agea*gndr, weights=pspwght, data=netidf)
mudel_multilog <- multinom(netmult ~ agea + gndr + Haridus + agea*gndr, weights=pspwght, data=netidf)
mudel_multilog <- multinom(netmult ~ agea + gndr + Haridus + agea*gndr, weights=pspwght, data=netidf)
summary(mudel_multilog)
PseudoR2(mudel_multilog, which=c("Nagelkerke", "CoxSnell", "McFadden"))
mudel_multilog <- multinom(netmult ~ agea + gndr + Haridus + agea*gndr, weights=pspwght, data=netidf, model = TRUE)
PseudoR2(mudel_multilog, which=c("Nagelkerke", "CoxSnell", "McFadden"))
mudel_multilog <- multinom(netmult ~ agea + gndr + Haridus, weights=pspwght, data=netidf, model = TRUE)
PseudoR2(mudel_multilog, which=c("Nagelkerke", "CoxSnell", "McFadden"))
summary(mudel_multilog)
stargazer(mudel_multilog, type="text", dep.var.labels=c("II", "III", "IV"),
covariate.labels=c("Vanus", "Naine", "Kutse", "Kesk", "Kõrg", "Vabaliige"),
out="siss4.txt")
library(stargazer)
stargazer(mudel_multilog, type="text", dep.var.labels=c("II", "III", "IV"),
covariate.labels=c("Vanus", "Naine", "Kutse", "Kesk", "Kõrg", "Vabaliige"),
out="siss4.txt")
summary(mudel_multilog)
mudel_multilog <- multinom(netmult ~ agea + gndr + Haridus + agea*gndr, weights=pspwght, data=netidf, model = TRUE)
summary(mudel_multilog)
stargazer(mudel_multilog, type="text", dep.var.labels=c("II", "III", "IV"),
covariate.labels=c("Vanus", "Naine", "Kutse", "Kesk", "Kõrg", "Vanus*Naine", "Vabaliige"),
out="siss4.txt")
exp(1.436)
?star_gazer
?stargazer
summary(mudel_multilog)
stargazer(mudel_multilog, type="text", dep.var.labels=c("II", "III", "IV"),
covariate.labels=c("Vanus", "Naine", "Kutse", "Kesk", "Kõrg", "Vanus*Naine", "Vabaliige"),
out="siss4.txt")
exp(coef(mudel_multilog))
stargazer(mudel_multilog, type="text", dep.var.labels=c("II", "III", "IV"),
covariate.labels=c("Vanus", "Naine", "Kutse", "Kesk", "Kõrg", "Vanus*Naine", "Vabaliige"),
out="siss4.txt")
summary(mudel_multilog)
PseudoR2(mudel_multilog, which=c("Nagelkerke", "CoxSnell", "McFadden"))
exp(coef(mudel_multilog))
stargazer(mudel_multilog, type="text", dep.var.labels=c("II", "III", "IV"),
covariate.labels=c("Vanus", "Naine", "Kutse", "Kesk", "Kõrg", "Vanus*Naine", "Vabaliige"),
out="siss4.txt")
mudel_ordreg <- polr(netmult ~ agea + gndr + Haridus + agea*gndr, weights=pspwght, data = netidf, Hess=TRUE)
library(MASS)
mudel_ordreg <- polr(netmult ~ agea + gndr + Haridus + agea*gndr, weights=pspwght, data = netidf, Hess=TRUE)
netidf$netmult <- factor(netidf$netmult, levels = c("Madal", "Madal-keskmine", "Kõrge-keskmine", "Kõrge"))
mudel_multilog <- multinom(netmult ~ agea + gndr + Haridus + agea*gndr, weights=pspwght, data=netidf, model = TRUE)
summary(mudel_multilog)
PseudoR2(mudel_multilog, which=c("Nagelkerke", "CoxSnell", "McFadden"))
exp(coef(mudel_multilog))
stargazer(mudel_multilog, type="text", dep.var.labels=c("II", "III", "IV"),
covariate.labels=c("Vanus", "Naine", "Kutse", "Kesk", "Kõrg", "Vanus*Naine", "Vabaliige"),
out="siss4.txt")
mudel_ordreg <- polr(netmult ~ agea + gndr + Haridus + agea*gndr, weights=pspwght, data = netidf, Hess=TRUE)
summary(mudel_ordreg)
(sissordtabel <- coef(summary(mudel_ordreg)))
p <- round(pnorm(abs(mudelordtabel[, "t value"]), lower.tail = FALSE) * 2, 3)
(mudelordtabel <- coef(summary(mudel_ordreg)))
p <- round(pnorm(abs(mudelordtabel[, "t value"]), lower.tail = FALSE) * 2, 3)
(mudelordtabel <- cbind(mudelordtabel, "p value" = p))
mudelordtabel
#Lisame coefidele
(mudelordtabel <- cbind(mudelordtabel, "p value" = p))
exp(coef(summary((mudel_ordreg))))
PseudoR2(mudel_ordreg, which=c("Nagelkerke", "CoxSnell", "McFadden"))
PseudoR2(mudel_multilog, which=c("Nagelkerke", "CoxSnell", "McFadden"))
PseudoR2(mudel_bilog, which=c("Nagelkerke", "CoxSnell", "McFadden"))
PseudoR2(mudel_multilog, which=c("Nagelkerke", "CoxSnell", "McFadden"))
PseudoR2(mudel_ordreg, which=c("Nagelkerke", "CoxSnell", "McFadden"))
summary(mudel)
(mudelordtabel <- cbind(mudelordtabel, "p value" = p))
stargazer(mudelordtabel)
stargazer(mudelordtabel, type="text")
mudelordtabel
#Lisame p-väärtuse ka, mida MASSis ei anta (siin teeme coefide tabeli)
mudelordtabel <- coef(summary(mudel_ordreg))
p <- round(pnorm(abs(mudelordtabel[, "t value"]), lower.tail = FALSE) * 2, 3)
stargazer(mudelordtabel, type="text")
mudelordtabel <- cbind(mudelordtabel, "p value" = p)
stargazer(mudelordtabel, type="text")
stargazer(mudel)
stargazer(mudel, type = "text")
stargazer(mudel, type = "text", dep.var.labels="Netikasutus minutites", covariate.labels = "Vanus", "Naine", "Kutseharidus", "Keskharidus", "Kõrgharidus", "Vanus*Naine", "Vabaliige")
?stargazer
stargazer(mudel, type = "text", dep.var.labels="Netikasutus minutites", covariate.labels = "Vanus", "Naine", "Kutseharidus", "Keskharidus", "Kõrgharidus", "Vanus*Naine", "Vabaliige") %>%
kbl() %>%
kable_classic()
library(kableExtra)
stargazer(mudel, type = "text", dep.var.labels="Netikasutus minutites", covariate.labels = "Vanus", "Naine", "Kutseharidus", "Keskharidus", "Kõrgharidus", "Vanus*Naine", "Vabaliige") %>%
kbl() %>%
kable_classic()
stargazer(mudel, type = "text", dep.var.labels="Netikasutus minutites", covariate.labels = "Vanus", "Naine", "Kutseharidus", "Keskharidus", "Kõrgharidus", "Vanus*Naine", "Vabaliige")
stargazer(mudel, type = "text", dep.var.labels="Netikasutus minutites", covariate.labels = "Vanus", "Naine", "Kutseharidus", "Keskharidus", "Kõrgharidus", "Vanus*Naine", "Vabaliige")
stargazer(mudelordtabel, type="text")
stargazer(mudel, type = "text", dep.var.labels="Netikasutus minutites", covariate.labels = "Vanus", "Naine", "Kutseharidus", "Keskharidus", "Kõrgharidus", "Vanus*Naine", "Vabaliige", title = "Lineaarne regressioon")
stargazer(mudel, type = "text", dep.var.labels="Netikasutus minutites", covariate.labels = "Vanus", "Naine", "Kutseharidus", "Keskharidus", "Kõrgharidus", "Vanus*Naine", "Vabaliige", title = "Lineaarne regressioon")
exp(coefficients(summary(mudel_bilog)))
stargazer(exp(coefficients(summary(mudel_bilog))))
stargazer(exp(coefficients(summary(mudel_bilog))), type = "text")
exp(coefficients(summary(mudel_bilog)))
summary(mudel_bilog)
stargazer(mudel_bilog, type = "text")
stargazer(mudel_bilog, type = "text", dep.var.labels="Netikasutus", covariate.labels = "Vanus", "Naine", "Kutseharidus", "Keskharidus", "Kõrgharidus", "Vanus*Naine", "Vabaliige", title = "Binaarne regressioon")
stargazer(mudel_multilog, type="text", dep.var.labels=c("II", "III", "IV"),
covariate.labels=c("Vanus", "Naine", "Kutse", "Kesk", "Kõrg", "Vanus*Naine", "Vabaliige"),
out="siss4.txt")
summary(mudel_multilog)
stargazer(mudel, type = "text", dep.var.labels="Netikasutus minutites", covariate.labels = "Vanus", "Naine", "Kutseharidus", "Keskharidus", "Kõrgharidus", "Vanus*Naine", "Vabaliige", title = "Lineaarne regressioon")
stargazer(mudel_bilog, type = "text", dep.var.labels="Netikasutus", covariate.labels = "Vanus", "Naine", "Kutseharidus", "Keskharidus", "Kõrgharidus", "Vanus*Naine", "Vabaliige", title = "Binomiaalne regressioon")
stargazer(mudel_multilog, type="text", dep.var.labels=c("Madalm-keskmine", "Kõrge-keskmine", "Kõrge"),
covariate.labels=c("Vanus", "Naine", "Kutse", "Kesk", "Kõrg", "Vanus*Naine", "Vabaliige"),
out="siss4.txt")
stargazer(mudelordtabel, type="text")
netidf <- essee18 %>%
select(netustm, agea, edulvlb, gndr, pspwght)
netidf <- essee18 %>%
select(netustm, agea, edulvlb, gndr, pspwght)
essee18
netidf <- essee18 %>%
select(netustm, agea, edulvlb, gndr, pspwght)
library(tidyverse)
netidf <- essee18 %>%
select(netustm, agea, edulvlb, gndr, pspwght)
stargazer(mudel, type = "text", dep.var.labels="Netikasutus minutites", covariate.labels = "Vanus", "Naine", "Kutseharidus", "Keskharidus", "Kõrgharidus", "Vanus*Naine", "Vabaliige", title = "Lineaarne regressioon", out="kodureg1.txt")
stargazer(mudel_bilog, type = "text", dep.var.labels="Netikasutus", covariate.labels = "Vanus", "Naine", "Kutseharidus", "Keskharidus", "Kõrgharidus", "Vanus*Naine", "Vabaliige", title = "Binomiaalne regressioon", out="kodureg2.txt")
stargazer(mudel_multilog, type="text", dep.var.labels=c("Madalm-keskmine", "Kõrge-keskmine", "Kõrge"), covariate.labels=c("Vanus", "Naine", "Kutse", "Kesk", "Kõrg", "Vanus*Naine", "Vabaliige"), out="kodureg3.txt")
stargazer(mudelordtabel, type="text", out="kodureg4.txt")
stargazer(mudel_multilog, type="text", dep.var.labels=c("Madalm-keskmine", "Kõrge-keskmine", "Kõrge"), covariate.labels=c("Vanus", "Naine", "Kutse", "Kesk", "Kõrg", "Vanus*Naine", "Vabaliige"), title = "Multinomiaalne logistiline regressioon", out="kodureg3.txt")
stargazer(mudel_multilog, type="text", dep.var.labels=c("Madalam-keskmine", "Kõrgem-keskmine", "Kõrge"), covariate.labels=c("Vanus", "Naine", "Kutse", "Kesk", "Kõrg", "Vanus*Naine", "Vabaliige"), title = "Multinomiaalne logistiline regressioon", out="kodureg3.txt")
stargazer(mudelordtabel, type="text", out="kodureg4.txt")
stargazer(mudelordtabel, type="text", out="kodureg4.txt", title = "Ordinaalne regressioon")
knitr::opts_chunk$set(echo = TRUE)
library(VGAM)
library(VGAM)
mudel_ordreg2 <- vglm(netmult ~ agea + gndr + Haridus + agea*gndr, family = cumulative, weights=pspwght, data = netidf)
netmult
netidf$netmult
mudel_ordreg2 <- vglm(netmult ~ agea + gndr + Haridus + agea*gndr, family = cumulative, weights=pspwght, data = netidf)
netidf$netmultord <- as.numeric(netidf$netmult)
mudel_ordreg2 <- vglm(netmultord ~ agea + gndr + Haridus + agea*gndr, family = cumulative, weights=pspwght, data = netidf)
summary(mudel_ordreg2)
mudel_ordreg2 <- vglm(netmultord ~ agea + gndr + Haridus + agea*gndr, family = cumulative(parallel = TRUE), weights=pspwght, data = netidf)
summary(mudel_ordreg2)
summary(mudel_bilog)
mudel_bin <- vglm(netbin ~ agea + gndr + Haridus + agea*gndr, family = binomial, weights=pspwght, data = netidf)
?vglm
?glm
glm()
?glm()
summary(mudel_ordreg2)
stargazer(mudel_ordreg2, type = "text")
exp(coefficients(summary(mudel_bilog)))
summary(mudel)
mudel <- lm(juurnet ~ agea + gndr + Haridus + agea*gndr, Haridus*gndr, data=netidf, weights=pspwght)
mudel <- lm(juurnet ~ agea + gndr + Haridus + agea*gndr, Haridus*gndr,  data=netidf, weights=pspwght)
mudel <- lm(juurnet ~ agea + gndr + Haridus + agea*gndr+ Haridus*gndr,  data=netidf, weights=pspwght)
summary(mudel)
mudel <- lm(juurnet ~ agea + gndr + Haridus + agea*gndr+ Haridus*gndr + agea*gndr*Haridus,  data=netidf, weights=pspwght)
summary(mudel)
mudel_bilog <- glm(netbin ~ agea + gndr + Haridus + agea*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
levels(netidf$gndr)
factor(netidf$gndr)
factor(netidf$gndr, levels = c("Mees", "Naine"))
netidf$gndr <- factor(netidf$gndr, levels = c("Mees", "Naine"))
mudel_bilog <- glm(netbin ~ agea + gndr + Haridus + agea*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
summary(mudel_bilog)
exp(coefficients(summary(mudel_bilog)))
mudel_bilog <- glm(netbin ~ agea + gndr + Haridus + agea*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
select(netustm, agea, edulvlb, gndr, pspwght)
netidf <- essee18 %>%
select(netustm, agea, edulvlb, gndr, pspwght)
library(TAM)
library(ggpubr)
library(ggplot2)
library(forcats)
library(olsrr)
library(essurvey)
library(tidyverse)
library(matrixStats)
library(reldist)
library(DescTools)
library(lmtest)
library(stargazer)
library(VGAM)
set_email("siimpoldre@gmail.com")
essee18 <-
import_country(
country = "Estonia",
rounds = c(9),
format="spss"
)
netidf <- essee18 %>%
select(netustm, agea, edulvlb, gndr, pspwght)
netidf <- essee18 %>%
select("netustm", "agea", "edulvlb", "gndr", "pspwght")
essee18 %>%
select(netustm, agea, edulvlb, gndr, pspwght)
netidf <- essee18 %>%
dplyr::select(netustm, agea, edulvlb, gndr, pspwght)
netidf$Haridus <- car::recode(as.numeric((essee18$edulvlb)), "0:213='Kuni_põhi'; 229='Kutse'; 313='Kesk'; 321:423='Kutse'; 520:800='Kõrg'; 5555=NA")
netidf$Haridus <- factor(netidf$Haridus, levels=c("Kuni_põhi", "Kutse", "Kesk", "Kõrg", NA))
netidf$gndr <- car::recode(as.numeric(netidf$gndr), "1='Mees'; 2='Naine'")
netidf <- netidf %>%
filter(netustm != 1)
netidf$gndr <- factor(netidf$gndr, levels = c("Mees", "Naine"))
mudel_bilog <- glm(netbin ~ agea + gndr + Haridus + agea*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
PseudoR2(mudel_ordreg2, which=c("Nagelkerke", "CoxSnell", "McFadden") )
mudel_ordreg2 <- vglm(netmultord ~ agea + gndr + Haridus + agea*gndr, family = cumulative(parallel = TRUE), weights=pspwght, data = netidf, model = TRUE)
netidf$netmultord <- as.numeric(netidf$netmult)
netidf <- essee18 %>%
dplyr::select(netustm, agea, edulvlb, gndr, pspwght)
netidf$Haridus <- car::recode(as.numeric((essee18$edulvlb)), "0:213='Kuni_põhi'; 229='Kutse'; 313='Kesk'; 321:423='Kutse'; 520:800='Kõrg'; 5555=NA")
netidf$Haridus <- factor(netidf$Haridus, levels=c("Kuni_põhi", "Kutse", "Kesk", "Kõrg", NA))
weightedMedian(essee18$netustm, w=netidf$pspwght, na.rm=TRUE)
netidf$netbin [netidf$netustm <= 180] <- c("Alla_keskmise")
netidf$netbin [netidf$netustm > 180] <- c("Üle_keskmise")
netidf$netbin [is.na(netidf$netustm)] <- NA
netidf$netbin <- factor(netidf$netbin, levels = c("Alla_keskmise", "Üle_keskmise"))
wtd.quantile(essee18$netustm, q=c(0.25,0.5,0.75), na.rm = FALSE, weight=netidf$pspwght)
netidf$netmult [essee18$netustm <= 120] <- c("Madal")
netidf$netmult [essee18$netustm <= 180 & essee18$netustm > 120] <- c("Madal-keskmine")
netidf$netmult [essee18$netustm <= 360 & essee18$netustm > 180] <- c("Kõrge-keskmine")
netidf$netmult [essee18$netustm > 360] <- c("Kõrge")
netidf$netmult [is.na(netidf$netustm)] <- NA
netidf$netmult <- factor(netidf$netmult, levels = c("Madal", "Madal-keskmine", "Kõrge-keskmine", "Kõrge"))
netidf$gndr <- car::recode(as.numeric(netidf$gndr), "1='Mees'; 2='Naine'")
#remove NA-s and 1s
netidf <- netidf %>%
filter(netustm != 1)
netidf$netmultord <- as.numeric(netidf$netmult)
mudel_ordreg2 <- vglm(netmultord ~ agea + gndr + Haridus + agea*gndr, family = cumulative(parallel = TRUE), weights=pspwght, data = netidf, model = TRUE)
summary(mudel_ordreg2)
PseudoR2(mudel_ordreg2, which=c("Nagelkerke", "CoxSnell", "McFadden") )
PseudoR2(mudel_bilog, which=c("Nagelkerke", "CoxSnell", "McFadden"))
PseudoR2(mudel_multilog, which=c("Nagelkerke", "CoxSnell", "McFadden"))
PseudoR2(mudel_ordreg2, which=c("Nagelkerke", "CoxSnell", "McFadden") )
mudel_bilog <- glm(netbin ~ agea + gndr + Haridus + agea*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
summary(mudel_bilog)
netidf$gndr <- factor(netidf$gndr, levels = c("Mees", "Naine"))
mudel_bilog <- glm(netbin ~ agea + gndr + Haridus + agea*gndr, family=binomial(link="logit"), data=netidf, weights=pspwght)
summary(mudel_bilog)
levels(netidf$netbin)
wtd.quantile(essee18$netustm, q=c(0.25,0.5,0.75), na.rm = FALSE, weight=netidf$pspwght)
wtd.quantile(essee18$netustm, q=c(0.25,0.5,0.75), na.rm = FALSE, weight=netidf$pspwght)
hist(sqrt(netidf$netustm))
shapiro.test(sqrt(netidf$netustm))
shapiro.test(netidf$netustm)
shapiro.test(log(netidf$netustm))
par(mfrow=c(2,2))
plot(mudel)
par(mfrow=c(1,1))
plot(mudel, 4)
knitr::opts_chunk$set(echo = TRUE)
library(essurvey)
set_email("_________________@____.__") # jutumärkide vahele sisestage oma email, millega olete registreeritud ESS kasutajaks lehel www.europeansocialsurvey.org
ee8 <- import_country("Estonia", 8)
library(essurvey)
set_email("siimpoldre@gmail.com")
ee8 <- import_country("Estonia", 8)
stf <- ee8[, c("idno", "stflife", "stfeco", "stfgov", "stfdem", "stfedu", "stfhlth", "gndr", "eduyrs", "pspwght")]
stf[1:5, 2]
dist(stf[1:5, 2])
stf[1:5, 2:3]
stf[1:5, 2:3]
dist(stf[1:5,2:3])
stf[1:5, 2:7]
dist(stf[1:5, 2:7])
sqrt((9-7)^2 + (7-4)^2 + (4-2)^2 + (7-2)^2 + (6-8)^2 + (7-6)^2)
stf[1:5, 2:7]
dist(stf[1:5, 2:7], method = "manhattan")
hclust(d, method = "single")
d <- dist(naide)
plt <- ee8[, 52:59]
plt[plt == 2] <- 0
plt[1:15,]
round(dist(plt[1:15,], method = "binary"), 2)
library(descr)
freq(round(dist(plt[1:15,], method = "binary"), 2))
horisontaalne <- c(1:6)
vertikaalne <- c(4, 3, 1, 3, 5, 3)
naide <- data.frame(horisontaalne, vertikaalne)
rownames(naide) <- c("A", "B", "C", "D", "E", "F")
View(naide)
d <- dist(naide)
d
hclust(d, method = "single")
d_single <- hclust(d, method = "single")
plot(d_single)
d_complete <- hclust(d, method = "complete")
plot(d_complete)
d_average <- hclust(d, method = "average")
plot(d_average)
d_ward <- hclust(d, method = "ward.D2")
plot(d_ward)
econdat <- read.csv("http://www.ut.ee/~indrekso/sotsanalmeet/econfreedom2.csv")
econdat <- read.csv2("http://www.ut.ee/~indrekso/sotsanalmeet/econfreedom2.csv")
econdat
econdat %>%
filter(region== "Europe")
econdat
econdat %>%
filter(Region == "Europe")
library(tidyverse)
econdat %>%
filter(Region == "Europe")
econdat %>%
filter(Region == "Europe") %>%
select(6:17)
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
summarise_all(sd = sd())
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
summarise_all(sd)
econdat %>%
filter(Region == "Europe") %>%
select(6:17)
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
summarise_all(sd())
econdat %>%
filter(Region == "Europe") %>%
select(6:17)
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
summarise(across(1:12, mean))
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
summarise(across(1:12, mean))
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
summarise(across(1:12, mean))
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
summarise(across(1:12, mean(., rm.na = TRUE)))
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
summarise(across(1:12, mean, na.rm=TRUE))
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
summarise(across(1:12, sd, na.rm=TRUE))
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
summarise(across(1:12, range, na.rm=TRUE))
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
mutate(across(1:12, scale, na.rm=TRUE))
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
mutate(across(1:12), scale, na.rm=TRUE)
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
mutate(across(1:12, scale, na.rm=TRUE))
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
mutate(across(1:12), scale, na.rm=TRUE)
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
mutate(across(c(1:12), scale, na.rm=TRUE))
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
mutate(across(1:12, scale, na.rm=TRUE))
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
mutate(across(c(1:12), scale, na.rm=TRUE))
econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
mutate(across(c(1:12), scale))
scal_econ <- econdat %>%
filter(Region == "Europe") %>%
select(6:17) %>%
mutate(across(c(1:12), scale))
scal_econ
econdat %>%
filter(Region == "Europe") %>%
select(c(1, 6:17)) %>%
summarise(across(2:13, sd, na.rm=TRUE))
econdat %>%
filter(Region == "Europe") %>%
select(c(1, 6:17))
econdat %>%
filter(Region == "Europe") %>%
select(c(1, 6:17)) %>%
mutate(across(c(1:12), scale))
econdat %>%
filter(Region == "Europe") %>%
select(c(1, 6:17)) %>%
mutate(across(c(2:13), scale))
scaled_ward <- hclust(scaled_ward, method = "ward.D2")
scaled_ward <- hclust(scal_econ, method = "ward.D2")
scaled_ward <- hclust(scal_econ, method = "ward.D2", na.rm=TRUE)
scal_econ <- econdat %>%
filter(Region == "Europe") %>%
select(c(1, 6:17)) %>%
mutate(across(c(2:13), scale)) %>%
drop.na()
scal_econ <- econdat %>%
filter(Region == "Europe") %>%
select(c(1, 6:17)) %>%
mutate(across(c(2:13), scale)) %>%
drop_na()
scaled_ward <- hclust(scal_econ, method = "ward.D2")
hclust(scal_econ, method = "ward.D2")
scal_econ <- econdat %>%
filter(Region == "Europe") %>%
select(c(1, 6:17)) %>%
mutate(across(c(2:13), scale)) %>%
drop_na()
scal_econ
econdat %>%
filter(Region == "Europe") %>%
select(c(1, 6:17)) %>%
mutate(across(c(2:13), scale)) %>%
drop_na() %>%
column_to_rownames(1)
econdat %>%
filter(Region == "Europe") %>%
select(c(1, 6:17)) %>%
mutate(across(c(2:13), scale)) %>%
drop_na()
econdat %>%
filter(Region == "Europe") %>%
select(c(1, 6:17)) %>%
mutate(across(c(2:13), scale)) %>%
drop_na() %>%
column_to_rownames("Country.Name")
scal_econ <- econdat %>%
filter(Region == "Europe") %>%
select(c(1, 6:17)) %>%
mutate(across(c(2:13), scale)) %>%
drop_na() %>%
column_to_rownames("Country.Name")
scaled_ward <- hclust(scal_econ, method = "ward.D2")
econdat %>%
filter(Region == "Europe") %>%
select(c(1, 6:17)) %>%
mutate(across(c(2:13), scale)) %>%
drop_na()
hclust(scal_econ, method = "ward.D2")
scal_econ
scaled_ward <- hclust(scal_econ, method = "ward.D2")
d <- dist(scal_econ)
scaled_ward <- hclust(d, method = "ward.D2")
plot(scaled_ward)
scal_econ
scaled_ward
