geom_boxplot() +
theme(legend.position = "none")+
geom_vline(xintercept = 3025, linetype = "dashed", color ="darkgreen") +
annotate("text", x = 1.3, y = 0.38, label = "*Erindipiir", size = 2.5, color = "darkgreen")
andmed3 %>%
ggplot(aes(x=grspnum, fill = "green")) +
geom_boxplot() +
theme(legend.position = "none")+
geom_vline(xintercept = 3025, linetype = "dashed", color ="darkgreen") +
annotate("text", x = 3026, y = 0.38, label = "*Erindipiir", size = 5, color = "darkgreen")
andmed3 %>%
ggplot(aes(x=grspnum, fill = "green")) +
geom_boxplot() +
theme(legend.position = "none")+
geom_vline(xintercept = 3025, linetype = "dashed", color ="darkgreen") +
annotate("text", x = 3025, y = 0.38, label = "Erindipiir", size = 5, color = "darkgreen")+
geom_vline(xintercept = 4450, linetype = "dashed", color ="red") +
annotate("text", x = 4450, y = 0.38, label = "Äärmusliku erindi piir", size = 5, color = "red")
andmed3 %>%
ggplot(aes(x=grspnum, fill = "green")) +
geom_boxplot() +
theme(legend.position = "none")+
geom_vline(xintercept = 3025, linetype = "dashed", color ="darkgreen") +
annotate("text", x = 3025, y = 0.38, label = "Erindipiir", size = 5, color = "darkgreen")+
geom_vline(xintercept = 4450, linetype = "dashed", color ="red") +
annotate("text", x = 4450, y = 0.38, label = "Äärmusliku erindi piir", size = 5, color = "red")+
theme(axis.ticks.y = element_blank())
andmed3 %>%
ggplot(aes(x=grspnum, fill = "green")) +
geom_boxplot() +
theme(legend.position = "none")+
geom_vline(xintercept = 3025, linetype = "dashed", color ="darkgreen") +
annotate("text", x = 3025, y = 0.38, label = "Erindipiir", size = 5, color = "darkgreen")+
geom_vline(xintercept = 4450, linetype = "dashed", color ="red") +
annotate("text", x = 4450, y = 0.38, label = "Äärmusliku erindi piir", size = 5, color = "red")+
theme(axis.ticks.y = element_blank()) +
theme(axis.text.y = element_blank())
andmed3 %>%
ggplot(aes(x=grspnum, fill = "green")) +
geom_boxplot() +
theme(legend.position = "none")+
geom_vline(xintercept = 3025, linetype = "dashed", color ="darkgreen") +
annotate("text", x = 3025, y = 0.38, label = "Erindipiir", size = 5, color = "darkgreen")+
geom_vline(xintercept = 4450, linetype = "dashed", color ="red") +
annotate("text", x = 4450, y = 0.38, label = "Äärmusliku erindi piir", size = 5, color = "red")+
theme(axis.ticks.y = element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.title.y = element_blank())
summary(andmed3$grspnum)
andmed3 %>%
filter(grspnum > 3025) %>%
drop_na()
andmed3 %>%
filter(grspnum > 3025) %>%
drop_na() %>%
summarise(mean = mean(agea))
andmed3 %>%
filter(grspnum > 3025) %>%
drop_na() %>%
mutate(mean_age = mean(agea))
andmed3 %>%
filter(grspnum > 3025) %>%
drop_na() %>%
mutate(mean_age = mean(agea)) %>%
mutate(mean_edu = mean(eduyrs))
View(andmed)
colSums(is.na(andmed2))
sum(is.na(andmed2))
andmed2$valiidne <- NA
andmed2$valiidne[complete.cases(andmed2)] <- 1
andmed2$valiidne[!complete.cases(andmed2)] <- 0
# arvutame täisvastustega indiviidide osakaalu
freq(andmed2$valiidne)
View(andmed2)
andmed2 <- ee9[,c(colnames(ee9[, 18:24]), "gndr", "agea", "eduyrs", "rlgdgr", "brncntr")]
andmed2 %>%
is.na() %>%
summary(n = n())
andmed2$valiidne <- NA
andmed1 <- ee9[,c(colnames(ee9[, 18:24]), "gndr", "agea", "eduyrs", "rlgdgr", "brncntr")]
andmed1 %>%
is.na() %>%
summary(n = n())
# kui palju on tunnustes andmelünki?
colSums(is.na(andmed1))
sum(is.na(andmed1))
as.data.frame(sum(is.na(andmed1)))
?as.data.frame
as.data.frame(sum(is.na(andmed1)), col.names="Total missing values")
as.data.frame(sum(is.na(andmed1)), col.names=c("Total missing values"))
as.data.frame(sum(is.na(andmed1)), col.names=c("Total missing values"))
as.data.frame(sum(is.na(andmed1)), col.names=names("Total missing values"))
as.data.frame(sum(is.na(andmed1)), col.names=c("Total missing values"))
as.data.frame(sum(is.na(andmed1)))
# kui palju on tunnustes andmelünki?
colSums(is.na(andmed1))
as.data.frame(colSums(is.na(andmed1)))
andmed1 %>%
mutate(isna = is.na())
andmed1 %>%
is.na() %>%
summarise(n = n())
andmed1 %>%
is.na() %>%
count()
andmed1 %>%
is.na() %>%
summarise(n = n())
andmed1 %>%
is.na() %>%
mutate(n = n())
andmed1 %>%
is.na() %>%
summarise(na = count())
andmed1 %>%
is.na()
andmed1 %>%
is.na() %>%
summary(n =n())
andmed1 %>%
is.na() %>%
summary(n =n()) %>%
as.data.frame()
andmed1 %>%
is.na() %>%
summary(n =n()) %>%
table()
andmed1 %>%
summarise_all(funs(sum(!is.na(.))))
andmed1 %>%
summarise_all(funs(sum(is.na(.))))
andmed1 %>%
summarise_all(funs(sum(is.na(.)))) %>%
pivot_longer(cols ="tulp", names_to = "NA-de arv")
?pivot_longer
andmed1 %>%
summarise_all(funs(sum(is.na(.)))) %>%
pivot_longer(names_to = "NA-de arv")
andmed1 %>%
summarise_all(funs(sum(is.na(.)))) %>%
pivot_longer(names_to = "Tulp", values_to = "Puuduvate arv")
andmed1 %>%
summarise_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(), names_to = "Tulp", values_to = "Puuduvate arv")
Puuduvad <- andmed1 %>%
summarise_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(), names_to = "Tulp", values_to = "Puuduvate arv")
Olemas <- andmed1 %>%
summarise_all(funs(sum(!is.na(.)))) %>%
pivot_longer(everything(), names_to = "Tulp", values_to = "Olemas_arv")
cbind(Puuduvad, Olemas$Olemas_arv)
colnames(tabel1) <- c("Tunnus", "Puuduvate arv", "Olemas arv")
tabel1 <- cbind(Puuduvad, Olemas$Olemas_arv)
colnames(tabel1) <- c("Tunnus", "Puuduvate arv", "Olemas arv")
andmed2 <- ee9[,c(colnames(ee9[, 18:24]), "gndr", "agea", "eduyrs", "rlgdgr", "brncntr")]
andmed2 <- ee9[,c(colnames(ee9[, 18:24]), "gndr", "agea", "eduyrs", "rlgdgr", "brncntr")]
# teeme indikaatortunnuse, mis näitab täielike vastustega indiviidide osakaalu andmestikus
andmed2$valiidne <- NA
andmed2$valiidne[complete.cases(andmed1)] <- 1
andmed2$valiidne[!complete.cases(andmed1)] <- 0
# arvutame täisvastustega indiviidide osakaalu
freq(andmed2$valiidne)
andmed2 <- ee9[,c(colnames(ee9[, 18:24]), "gndr", "agea", "eduyrs", "rlgdgr", "brncntr")]
# teeme indikaatortunnuse, mis näitab täielike vastustega indiviidide osakaalu andmestikus
andmed2$valiidne <- NA
andmed2$valiidne[complete.cases(andmed1)] <- 1
andmed2$valiidne[!complete.cases(andmed1)] <- 0
# arvutame täisvastustega indiviidide osakaalu
freq(andmed2$valiidne)
# arvutame täisvastustega indiviidide osakaalu
table(andmed2$valiidne)
freq
# arvutame täisvastustega indiviidide osakaalu
freq(andmed2$valiidne)
# arvutame täisvastustega indiviidide osakaalu
as.data.frame(freq(andmed2$valiidne))
?freq
as.data.frame(freq(andmed2$valiidne, plot = FALSE))
andmed2 %>%
group_by(gndr) %>%
summarise(valiid_osakaal = mean(valiidne))
andmed2 %>%
group_by(gndr) %>%
summarise(`valiidsete osakaal` = mean(valiidne))
andmed2 %>%
group_by(gndr) %>%
summarise(valiid_osakaal = mean(valiidne))
as.data.frame(freq(andmed2$valiidne, plot = FALSE), row.names = c("Vale", "Oige"))
as.data.frame(freq(andmed2$valiidne, plot = FALSE))
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rowid_to_column()
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rowname_to_column()
as.data.frame(freq(andmed2$valiidne, plot = FALSE))
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_columnn(var = "Väärtus")
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_columnn()
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_columnn() %>%
as_tibble()
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_columnn()
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column()
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column(var = "Value")
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column(var = "Value") %>%
mutate(Value = recode(Value, `0`="Puudu", `1` = "Olemas"))
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column(var = "Value") %>%
mutate(Value = recode(Value, `0`="Missing", `1` = "valid"))
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column(var = "Value") %>%
mutate(Value = recode(Value, `0`="Not complete", `1` = "Complete))
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column(var = "Value") %>%
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column(var = "Value") %>%
mutate(Value = recode(Value, `0`="Not complete", `1` = "Complete"))
andmed2 %>%
group_by(valiidne) %>%
summarise(keskm_vanus = mean(agea))
andmed2 %>%
group_by(valiidne) %>%
summarise(keskm_vanus = mean(agea))
andmed2$vanusegrupp <- NA
andmed2$vanusegrupp[andmed2$agea >= 15] <- '15-25'
andmed2$vanusegrupp[andmed2$agea >= 26] <- '26-35'
andmed2$vanusegrupp[andmed2$agea >= 36] <- '36-45'
andmed2$vanusegrupp[andmed2$agea >= 46] <- '46-55'
andmed2$vanusegrupp[andmed2$agea >= 56] <- '56-65'
andmed2$vanusegrupp[andmed2$agea >= 66] <- '66-75'
andmed2$vanusegrupp[andmed2$agea >= 76] <- '76+'
andmed2 %>%
group_by(vanusegrupp) %>%
summarise(valiid_osakaal = mean(valiidne)) %>%
ggplot(aes(x=vanusegrupp, y = valiid_osakaal, color = vanusegrupp)) +
geom_point() +
ylim(0, 1) +
scale_colour_manual(values=c(hue_pal(h = c(90, 180))(7))) +
xlab("Vanusegrupp") +
ylab("Täisvastuste osakaal") +
theme(legend.position = "none")
andmed2%>%
arrange(agea) %>%
missing_plot()
andmed2 %>%
group_by(rlgdgr) %>%
summarise(valiid_osakaal = mean(valiidne))
library(kableExtra)
as.data.frame(colSums(is.na(andmed1)))
as.data.frame(colSums(is.na(andmed1))) %>%
rename(Frame = `colSums(is.na(andmed1))`)
as.data.frame(colSums(is.na(andmed1))) %>%
rename(Puudu = `colSums(is.na(andmed1))`) %>%
kbl()
tabel1 %>%
kbl
tabel1 %>%
kbl %>%
kbl_classic()
tabel1 %>%
kbl %>%
kable_classic()
as.data.frame(colSums(is.na(andmed1))) %>%
rename(Puudu = `colSums(is.na(andmed1))`) %>%
kbl() %>%
kabel_classic
andmed2%>%
arrange(eduyrs) %>%
missing_plot()
explanatory = colnames(andmed2)[1:7]
andmed2 %>%
missing_pattern(explanatory)
andmed3 %>%
select(grspnum) %>%
filter(grspnum > 3025) %>%
drop_na() %>%
filter(grspnum > 4450)
write.csv(ee9, "dats.csv")
ee9 <- read.csv("data.csv")
ee9 <- read_csv("data.csv")
ee9 <- read_csv("dats.csv")
?missing_patter
?missing_pattern
andmed2 %>%
missing_pattern(explanatory)[2]
explanatory = colnames(andmed2)[1:7]
andmed2 %>%
missing_pattern(explanatory)
as.data.frame(summary(andmed3$grspnum))
as.data.frame(stat.desc(andmed3$grspnum))
as.data.frame(stat.desc(andmed3$grspnum)) %>%
kbl() %>%
kable_classic()
as.data.frame(stat.desc(andmed3$grspnum)) %>%
rename(Väärtus = "stat.desc(andmed3$grspnum)")
kbl() %>%
kable_classic()
as.data.frame(stat.desc(andmed3$grspnum)) %>%
rename(Väärtus = "stat.desc(andmed3$grspnum)") %>%
kbl() %>%
kable_classic()
summary(andmed3$grspnum)
andmed3 %>%
select(grspnum) %>%
filter(grspnum > 3025) %>%
drop_na() %>%
filter(grspnum > 4450)
andmed3 %>%
select(grspnum) %>%
filter(grspnum > 3025) %>%
count()
as.data.frame(stat.desc(andmed3$grspnum)) %>%
rename(Väärtus = "stat.desc(andmed3$grspnum)") %>%
kbl() %>%
kable_classic()
summary(andmed3$grspnum)
andmed3 %>%
ggplot(aes(x=grspnum, fill = "green")) +
geom_boxplot() +
theme(legend.position = "none")+
geom_vline(xintercept = 3025, linetype = "dashed", color ="darkgreen") +
annotate("text", x = 3025, y = 0.38, label = "Erindipiir", size = 5, color = "darkgreen")+
geom_vline(xintercept = 4450, linetype = "dashed", color ="red") +
annotate("text", x = 4450, y = 0.38, label = "Äärmusliku erindi piir", size = 5, color = "red")+
theme(axis.ticks.y = element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.title.y = element_blank())
andmed3 %>%
filter(grspnum > 3025) %>%
drop_na() %>%
mutate(mean_age = mean(agea)) %>%
mutate(mean_edu = mean(eduyrs)) %>%
kbl() %>%
kable_classic()
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column(var = "Value") %>%
mutate(Value = recode(Value, `0`="Not complete", `1` = "Complete")) %>%
kbl() %>%
kable_classic()
andmed1 <- ee9[,c(colnames(ee9[, 18:24]), "gndr", "agea", "eduyrs", "rlgdgr", "brncntr")]
Puuduvad <- andmed1 %>%
summarise_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(), names_to = "Tulp", values_to = "Puuduvate arv")
Olemas <- andmed1 %>%
summarise_all(funs(sum(!is.na(.)))) %>%
pivot_longer(everything(), names_to = "Tulp", values_to = "Olemas_arv")
tabel1 <- cbind(Puuduvad, Olemas$Olemas_arv)
colnames(tabel1) <- c("Tunnus", "Puuduvate arv", "Valiidsete arv")
tabel1 %>%
kbl() %>%
kable_classic()
andmed2 <- ee9[,c(colnames(ee9[, 18:24]), "gndr", "agea", "eduyrs", "rlgdgr", "brncntr")]
# teeme indikaatortunnuse, mis näitab täielike vastustega indiviidide osakaalu andmestikus
andmed2$valiidne <- NA
andmed2$valiidne[complete.cases(andmed1)] <- 1
andmed2$valiidne[!complete.cases(andmed1)] <- 0
# arvutame täisvastustega indiviidide osakaalu
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column(var = "Value") %>%
mutate(Value = recode(Value, `0`="Not complete", `1` = "Complete")) %>%
kbl() %>%
kable_classic()
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column(var = "Value") %>%
mutate(Value = recode(Value, `0`="Not complete", `1` = "Complete", )) %>%
kbl() %>%
kable_classic()
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column(var = "Value") %>%
mutate(Value = recode(Value, `0`="Not complete", `1` = "Complete", NA = NA)) %>%
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column(var = "Value") %>%
mutate(Value = recode(Value, `0`="Not complete", `1` = "Complete"))
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column(var = "Value")
as.data.frame(freq(andmed2$valiidne, plot = FALSE))
tabel1 %>%
kbl() %>%
kable_classic()
freq(andmed2$valiidne)
andmed2$valiidne <- NA
andmed2$valiidne[complete.cases(andmed1)] <- 1
andmed2$valiidne[!complete.cases(andmed1)] <- 0
andmed2$valiidne <- NA
andmed2$valiidne[complete.cases(andmed2)] <- 1
andmed2$valiidne[!complete.cases(andmed2)] <- 0
freq(andmed2$valiidne)
andmed2
andmed2$valiidne <- NA
andmed2$valiidne[complete.cases(andmed2[1:12])] <- 1
andmed2$valiidne[!complete.cases(andmed2[1:12])] <- 0
freq(andmed2$valiidne)
tabel1 %>%
kbl() %>%
kable_classic()
View(ee9)
colnames(ee9[, 18:24])
c(colnames(ee9[, 19:25])
colnames(ee9[, 19:25])
colnames(ee9[, 19:25])
Puuduvad <- andmed1 %>%
summarise_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(), names_to = "Tulp", values_to = "Puuduvate arv")
Olemas <- andmed1 %>%
summarise_all(funs(sum(!is.na(.)))) %>%
pivot_longer(everything(), names_to = "Tulp", values_to = "Olemas_arv")
tabel1 <- cbind(Puuduvad, Olemas$Olemas_arv)
colnames(tabel1) <- c("Tunnus", "Puuduvate arv", "Valiidsete arv")
tabel1 %>%
kbl() %>%
kable_classic()
freq(andmed2$rlgdgr)
Puuduvad <- andmed2 %>%
summarise_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(), names_to = "Tulp", values_to = "Puuduvate arv")
Olemas <- andmed2 %>%
summarise_all(funs(sum(!is.na(.)))) %>%
pivot_longer(everything(), names_to = "Tulp", values_to = "Olemas_arv")
tabel1 <- cbind(Puuduvad, Olemas$Olemas_arv)
colnames(tabel1) <- c("Tunnus", "Puuduvate arv", "Valiidsete arv")
tabel1 %>%
kbl() %>%
kable_classic()
andmed2 <- ee9[,c(colnames(ee9[, 19:25]), "gndr", "agea", "eduyrs", "rlgdgr", "brncntr")]
Puuduvad <- andmed2 %>%
summarise_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(), names_to = "Tulp", values_to = "Puuduvate arv")
Olemas <- andmed2 %>%
summarise_all(funs(sum(!is.na(.)))) %>%
pivot_longer(everything(), names_to = "Tulp", values_to = "Olemas_arv")
tabel1 <- cbind(Puuduvad, Olemas$Olemas_arv)
colnames(tabel1) <- c("Tunnus", "Puuduvate arv", "Valiidsete arv")
tabel1 %>%
kbl() %>%
kable_classic()
# teeme indikaatortunnuse, mis näitab täielike vastustega indiviidide osakaalu andmestikus
andmed2$valiidne <- NA
andmed2$valiidne[complete.cases(andmed2[1:12])] <- 1
andmed2$valiidne[!complete.cases(andmed2[1:12])] <- 0
# arvutame täisvastustega indiviidide osakaalu
as.data.frame(freq(andmed2$valiidne, plot = FALSE)) %>%
rownames_to_column(var = "Value") %>%
mutate(Value = recode(Value, `0`="Not complete", `1` = "Complete")) %>%
kbl() %>%
kable_classic()
andmed2 %>%
group_by(gndr) %>%
summarise(valiid_osakaal = mean(valiidne)) %>%
kbl() %>%
kable_classic()
andmed2 %>%
group_by(valiidne) %>%
summarise(keskm_vanus = mean(agea)) %>%
kbl() %>%
kable_classic()
andmed2$vanusegrupp <- NA
andmed2$vanusegrupp[andmed2$agea >= 15] <- '15-25'
andmed2$vanusegrupp[andmed2$agea >= 26] <- '26-35'
andmed2$vanusegrupp[andmed2$agea >= 36] <- '36-45'
andmed2$vanusegrupp[andmed2$agea >= 46] <- '46-55'
andmed2$vanusegrupp[andmed2$agea >= 56] <- '56-65'
andmed2$vanusegrupp[andmed2$agea >= 66] <- '66-75'
andmed2$vanusegrupp[andmed2$agea >= 76] <- '76+'
andmed2 %>%
group_by(vanusegrupp) %>%
summarise(valiid_osakaal = mean(valiidne)) %>%
ggplot(aes(x=vanusegrupp, y = valiid_osakaal, color = vanusegrupp)) +
geom_point() +
ylim(0, 1) +
scale_colour_manual(values=c(hue_pal(h = c(90, 180))(7))) +
xlab("Vanusegrupp") +
ylab("Täisvastuste osakaal") +
theme(legend.position = "none")
andmed2%>%
arrange(agea) %>%
missing_plot()
andmed2 %>%
group_by(rlgdgr) %>%
summarise(valiid_osakaal = mean(valiidne)) %>%
kbl() %>%
kable_classic()
freq(andmed2$rlgdgr)
andmed2 %>%
mutate(rlgdgr = recode(rlgdgr, `Not at all religious` = "Pole religiossne", `Very religious` = "Väga religioossne")) %>%
group_by(rlgdgr) %>%
summarise(valiid_osakaal = mean(valiidne)) %>%
ggplot(aes(x=rlgdgr, y = valiid_osakaal, color = rlgdgr)) +
geom_point() +
ylim(0, 1) +
scale_colour_manual(values=c(hue_pal(h = c(90, 180))(11)), na.value = "#00C1A9") +
xlab("Religiossuse tase") +
ylab("Täisvastuste osakaal") +
theme(axis.text.x =element_text(angle = 45)) +
theme(legend.position = "none")
andmed2 %>%
filter(!is.na(rlgdgr)) %>%
mutate(rlgdgr2 = recode(rlgdgr, `Not at all religious` = 0, `Very religious` = 10, `1` = 1,
`2` = 2, `3` = 3, `4` = 4, `5` = 5, `6` = 6, `7` = 7, `8` = 8, `9` = 9)) %>%
group_by(valiidne) %>%
summarise(keskm_religioossus = mean(rlgdgr2)) %>%
kbl() %>%
kable_classic
andmed2 %>%
group_by(brncntr) %>%
summarise(valiid_osakaal = mean(valiidne)) %>%
kbl() %>%
kable_classic
andmed2
